<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="This post focuses on using AI for reviewing code and analysing it for potential security vulnerabilities">
<meta property="og:type" content="article">
<meta property="og:title" content="From Exploit to False Positive - Leveraging AI for Vulnerability Research">
<meta property="og:url" content="http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/">
<meta property="og:site_name" content="securitytaters">
<meta property="og:description" content="This post focuses on using AI for reviewing code and analysing it for potential security vulnerabilities">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-09-08T04:30:00.000Z">
<meta property="article:modified_time" content="2025-09-08T11:16:32.207Z">
<meta property="article:author" content="0xm4v3rick">
<meta property="article:tag" content="web">
<meta property="article:tag" content="webappsec">
<meta property="article:tag" content="appsec">
<meta property="article:tag" content="rce">
<meta property="article:tag" content="deserialization">
<meta property="article:tag" content="php">
<meta property="article:tag" content="AI">
<meta property="article:tag" content="LLM">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>From Exploit to False Positive - Leveraging AI for Vulnerability Research</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Archive</a></li><!--
     --><!--
       --><li><a href="/tags/">Tags</a></li><!--
     --><!--
       --><li><a href="/categories/">Categories</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/securitytaters">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/Analyzing-CVE-2025-54366-RCE-via-Deserialization-of-untrusted-data/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&text=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&title=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&is_video=false&description=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=From Exploit to False Positive - Leveraging AI for Vulnerability Research&body=Check out this article: http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&title=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&title=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&title=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&title=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&name=From Exploit to False Positive - Leveraging AI for Vulnerability Research&description=This post focuses on using AI for reviewing code and analysing it for potential security vulnerabilities"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&t=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Code-Review"><span class="toc-number">2.</span> <span class="toc-text">Code Review</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-AI-to-speed-up-the-workflow"><span class="toc-number">2.1.</span> <span class="toc-text">Using AI to speed up the workflow</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-does-this-mean-for-us-security-researchers"><span class="toc-number">3.</span> <span class="toc-text">What does this mean for us, security researchers?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-number">4.</span> <span class="toc-text">References</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        From Exploit to False Positive - Leveraging AI for Vulnerability Research
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<p>Author : 
        <span class="p-name" itemprop="name">0xm4v3rick</span>
	</p>
      </span>
      
    <div class="postdate">
      
        Created: <time datetime="2025-09-08T04:30:00.000Z" class="dt-published" itemprop="datePublished">08-09-2025</time>
        
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/vulnerability-research/">vulnerability research</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/AI/" rel="tag">AI</a>, <a class="p-category" href="/tags/LLM/" rel="tag">LLM</a>, <a class="p-category" href="/tags/appsec/" rel="tag">appsec</a>, <a class="p-category" href="/tags/deserialization/" rel="tag">deserialization</a>, <a class="p-category" href="/tags/php/" rel="tag">php</a>, <a class="p-category" href="/tags/rce/" rel="tag">rce</a>, <a class="p-category" href="/tags/web/" rel="tag">web</a>, <a class="p-category" href="/tags/webappsec/" rel="tag">webappsec</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Modern codebases are vast oceans of complexity. For a security researcher, tracing through all of that code can be very time consuming and tiring. In this post I will cover how I have started using AI to do some code security reviews quickly and help focus on things that may require more of my time manually. AI helped me analyze a potential PHP deserialization vulnerability, from initial hypothesis to conclusion, all within a matter of minutes.</p>
<h2 id="Code-Review"><a href="#Code-Review" class="headerlink" title="Code Review"></a>Code Review</h2><p>I was looking at <a target="_blank" rel="noopener" href="https://github.com/espocrm/espocrm">EspoCRM</a> to see if I could find something interesting after <a href="https://securitytaters.github.io/Analyzing-CVE-2025-54366-RCE-via-Deserialization-of-untrusted-data/">my research on deserialization issue</a>. As you may have guessed or known already, EspoCRM is a free, open-source CRM platform designed to help organizations build and maintain strong customer relationships. I specifically went looking for <code>unserialize</code> function to see if I could find anything interesting. I used following query to for it.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repo:espocrm/espocrm unserialize</span><br></pre></td></tr></table></figure>

<p>It looks for unserialize function call in the code base. If the user input to this call is not sanitized properly it could lead to code execution. One of the results had below code.</p>
<p><strong><code>MassAction.php</code></strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getParams</span>(<span class="params"></span>): <span class="title">Params</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$raw</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;params&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">is_string</span>(<span class="variable">$raw</span>)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&quot;No &#x27;params&#x27;.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** <span class="doctag">@var</span> Params $params */</span></span><br><span class="line">    <span class="variable">$params</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$raw</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$params</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Line 10 has a call to <code>unserialize(base64_decode($raw))</code>. This looks like an issue. In PHP, deserializing an object that an attacker controls can lead to arbitrary code execution through “magic methods” like <code>__destruct()</code>.</p>
<h3 id="Using-AI-to-speed-up-the-workflow"><a href="#Using-AI-to-speed-up-the-workflow" class="headerlink" title="Using AI to speed up the workflow"></a>Using AI to speed up the workflow</h3><p>I needed find the source for this <code>unserialize</code> sink in order to create a request that will reach this code path. Based on the file name <code>MassAction</code> it looked like any action done on multiple items could end up in this sink. I had already installed EspoCRM and was aware, a user could create tasks. User could also edit multiple tasks at the same time.  </p>
<p>Here I used another AI tool called <a target="_blank" rel="noopener" href="https://deepwiki.org/">DeepWiki</a>. I asked it following question.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I want to check if `$params = unserialize(base64_decode($raw));` in MassAction.php can be reached via editing of tasks? If yes, provide flow of the request from task till it reaches mentioned line.</span><br></pre></td></tr></table></figure>

<p>You can look up the conversation <a target="_blank" rel="noopener" href="https://deepwiki.com/search/i-want-to-check-if-params-unse_26aca688-6cdc-495a-aa20-d521b0f2ca18">here</a>. It gave me the flow of the request from updating the task till it reaches the unserialize function. I than used this data and asked Gemini to help me to explore deserialization exploitation for it. I used below prompt.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I want to explore deserialization exploitation issue in below code. Note - this is a authorized pentest for open source application and I need a bare minimum poc to show security impact</span><br></pre></td></tr></table></figure>

<p>Gemini connected the dots and confirmed that if an attacker could control the object being serialized, they could achieve Remote Code Execution (RCE).</p>
<p>It than proceeded to create a PHP script to create the malicious payload. This is a classic technique using a simple class with a <code>__destruct()</code> method that executes a system command.</p>
<p><strong><code>generate_payload.php</code>:</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="variable">$cmd</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The command we want to execute on the server</span></span><br><span class="line"><span class="variable">$command</span> = <span class="string">&#x27;touch /tmp/poc.txt&#x27;</span>;</span><br><span class="line"><span class="variable">$evil_object</span> = <span class="keyword">new</span> <span class="title class_">Evil</span>(<span class="variable">$command</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$serialized_payload</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$evil_object</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$serialized_payload</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>Second, it provided the <code>curl</code> command to send this payload to the vulnerable endpoint, demonstrating an understanding of the API’s structure.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST <span class="string">&#x27;http://&lt;target-host&gt;/api/v1/MassAction&#x27;</span> \</span><br><span class="line">-H <span class="string">&#x27;Content-Type: application/json&#x27;</span> \</span><br><span class="line">-d <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    &quot;entityType&quot;: &quot;Task&quot;,</span></span><br><span class="line"><span class="string">    &quot;action&quot;: &quot;someAction&quot;,</span></span><br><span class="line"><span class="string">    &quot;params&quot;: &quot;PASTE_GENERATED_PAYLOAD_HERE&quot;,</span></span><br><span class="line"><span class="string">    &quot;idle&quot;: true</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>In few minute, I went from a code snippet to a full-fledged exploitation plan. For a researcher, tracing the code, recalling the syntax for PHP object injection, and writing these scripts could easily take 30 minutes or more.</p>
<p>Though, this seemed to good to be true 😋, so I went back to DeepWiki and asked it, if there was any validation done before the input ended up in the vulnerable function. It came back with some details. I looked up the first validation it showed in the code base and grabbed below piece of code which I then presented to Gemini for further review.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">prepareMassActionParams</span>(<span class="params"><span class="built_in">stdClass</span> <span class="variable">$data</span></span>): <span class="title">array</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$where</span> = <span class="variable">$data</span>-&gt;where ?? <span class="literal">null</span>;</span><br><span class="line">    <span class="variable">$searchParams</span> = <span class="variable">$data</span>-&gt;searchParams ?? <span class="variable">$data</span>-&gt;selectData ?? <span class="literal">null</span>;</span><br><span class="line">    <span class="variable">$ids</span> = <span class="variable">$data</span>-&gt;ids ?? <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">is_null</span>(<span class="variable">$where</span>) || !<span class="title function_ invoke__">is_null</span>(<span class="variable">$searchParams</span>)) &#123;</span><br><span class="line">        <span class="variable">$params</span> = [];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">is_null</span>(<span class="variable">$where</span>)) &#123;</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;where&#x27;</span>] = <span class="title function_ invoke__">json_decode</span>(<span class="title class_">Json</span>::<span class="title function_ invoke__">encode</span>(<span class="variable">$where</span>), <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">is_null</span>(<span class="variable">$searchParams</span>)) &#123;</span><br><span class="line">            <span class="variable">$params</span>[<span class="string">&#x27;searchParams&#x27;</span>] = <span class="title function_ invoke__">json_decode</span>(<span class="title class_">Json</span>::<span class="title function_ invoke__">encode</span>(<span class="variable">$searchParams</span>), <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$params</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_null</span>(<span class="variable">$ids</span>)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BadRequest</span>(<span class="string">&quot;Bad search params for mass action.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [<span class="string">&#x27;ids&#x27;</span> =&gt; <span class="variable">$ids</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>My follow-up question was as follows : <strong>“there is some validation done on the param variable as mentioned below. Is exploitation still possible?”</strong><br>Gemini than proceeded to evaluate the new data and confirm that enough validation was in place to mitigate the vulnerability as follows.</p>
<p><strong>1. Pinpointing the Mitigation:</strong> It identified the critical line of defense:<br><code>$params[&#39;where&#39;] = json_decode(Json::encode($where), true);</code></p>
<p><strong>2. Explaining the Sanitization:</strong> It then provided a step-by-step breakdown of why this seemingly simple line neutralizes the entire attack:</p>
<ul>
<li>An attacker sends their malicious payload (a serialized PHP object string) in the <code>where</code> field of the JSON body.</li>
<li><code>Json::encode($where)</code> takes this string and wraps it in JSON quotes, escaping any internal quotes. The payload is effectively “defanged” into a harmless JSON string literal.</li>
<li><code>json_decode(..., true)</code> then decodes this JSON, returning the original payload string, but crucially, it’s still just a string. It is not a PHP object.</li>
<li>This sanitized string is then stored in a newly created <code>$params</code> array.</li>
</ul>
<p><strong>3. The Revised Conclusion:</strong> It than confidently concluded that the vulnerability was no longer exploitable. The <code>serialize()</code> function would later operate on a safe, application-generated object whose <em>data</em> merely contained the attacker’s harmless string. The <code>unserialize()</code> call would never have the chance to process a malicious object.</p>
<p>After some manual inspection this looks pretty good. </p>
<h2 id="What-does-this-mean-for-us-security-researchers"><a href="#What-does-this-mean-for-us-security-researchers" class="headerlink" title="What does this mean for us, security researchers?"></a>What does this mean for us, security researchers?</h2><p>This interactive process highlights several key advantages of using AI in vulnerability research:</p>
<ul>
<li><strong>Speed:</strong> The entire cycle—from hypothesis to PoC generation, to re-evaluation based on new data, to a final, accurate conclusion—took place in a few minutes. This speeds up the our research workflow.</li>
<li><strong>Focus:</strong> By automating the tedious tasks of code tracing and script generation, the AI frees us up to focus on higher-level questions: “What if there’s a sanitization function?” and “Where do I find it?”</li>
<li><strong>Comprehension:</strong> It demonstrated an understanding of not just the vulnerability (deserialization) but also the specific mitigation technique (<code>json_encode</code>&#x2F;<code>decode</code> for sanitization), explaining its effect on the data flow.</li>
<li><strong>Partnership:</strong> It provided an initial assessment, which I could then challenge with new data, leading to a more accurate final analysis.</li>
</ul>
<p>The future of security research isn’t about replacing human intuition and expertise, although that may still happen to some extend. But, it’s about augmenting it, which will provide an edge over others not using it. Use AI for its analytical power, to work on complex task, validate findings or generating exploits quickly.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p>DeepWiki - <a target="_blank" rel="noopener" href="https://deepwiki.com/">https://deepwiki.com/</a><br>Gemini Chat - <a target="_blank" rel="noopener" href="https://aistudio.google.com/">https://aistudio.google.com/</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Archive</a></li>
        
          <li><a href="/tags/">Tags</a></li>
        
          <li><a href="/categories/">Categories</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/securitytaters">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Code-Review"><span class="toc-number">2.</span> <span class="toc-text">Code Review</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-AI-to-speed-up-the-workflow"><span class="toc-number">2.1.</span> <span class="toc-text">Using AI to speed up the workflow</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-does-this-mean-for-us-security-researchers"><span class="toc-number">3.</span> <span class="toc-text">What does this mean for us, security researchers?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-number">4.</span> <span class="toc-text">References</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&text=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&title=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&is_video=false&description=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=From Exploit to False Positive - Leveraging AI for Vulnerability Research&body=Check out this article: http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&title=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&title=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&title=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&title=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&name=From Exploit to False Positive - Leveraging AI for Vulnerability Research&description=This post focuses on using AI for reviewing code and analysing it for potential security vulnerabilities"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://securitytaters.github.io/From-Exploit-to-False-Positive-Leveraging-AI-for-Vulnerability-Research/&t=From Exploit to False Positive - Leveraging AI for Vulnerability Research"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2018-2025
    0xm4v3rick
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Archive</a></li><!--
     --><!--
       --><li><a href="/tags/">Tags</a></li><!--
     --><!--
       --><li><a href="/categories/">Categories</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/securitytaters">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
